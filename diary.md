在公司开始实习，避免每天感到空虚，记录一下每天的学习过程吧

到公司老板给的第一个学习任务，让我优化疲劳驾驶的项目代码，顺便在Linux环境下重构...



# 11.28（星期四）

## 碎碎念：

今天是实习的第四天，周围都是强悍的同事，所幸他们都十分友善~~

研究研究以前一直感兴趣的markdown格式编写吧，从今天开始试着用这个写写日记



## Perf -- Linux性能优化工具

公司是算法公司，所以学一学这些代码热点分析工具吧

------



##  使用git

虽然以前学过这个，但是一直没机会用呀，现在慢慢熟悉吧，从上传这个日记开始~~

翻了翻以前收集的网站，总算把基本操作都熟悉了...

##  计算代码运行时间（opencv）

```c++
#include <opencv2/opencv.hpp>
#include "opencv2/imgproc/imgproc.hpp"
int64 startTime = cv::getTickCount();

//待计算运行时间的函数或代码段

double duration = (cv::getTickCount() - startTime) / cv::getTickFrequency();  //duration即为所计算运行时间
```

虽然visual studio 上有相应的工具，但是项目里有个动态库无法分析，一分析就报错，@#￥%……&*，只好用这个了

用这个方法，终于定位到消耗程序运行时间最多的代码段了...



# 11.29（星期五）

一天了...整整一天了...在**Ubuntu**上装**opencv**把我整疯了！！！，能编译但就是不能运行？？

```c
terminate called after throwing an instance of 'cv::Exception'
  what():  OpenCV(3.4.4) /home/gec/Desktop/sources/modules/highgui/src/window.cpp:698: error: (-2:Unspecified error) The function is not implemented. Rebuild the library with Windows, GTK+ 2.x or Carbon support. If you are on Ubuntu or Debian, install libgtk2.0-dev and pkg-config, then re-run cmake or configure script in function 'cvWaitKey'
```

我早就装了**libgtk2.0-dev  pkg-config**这两个玩意了好吧，整的我重装了好几次**opencv**，还是装不好，我去你妈的！还有用**cmake-gui**装**opencv**，你他们没事链接我的arm qt 库干嘛？？？？

------

拖了两天，总算开始写论文前三章，话说这老师从来不过问我们的毕业设计和毕业论文，~~真是高傲~~，也不知道在想什么...

------

今天终于把疲劳驾驶那个项目最消耗性能的代码层层定位出来了，不能用工具，只能一行行用函数去测试，编译还十分耗时，真是的。。定位之后发现果然不是我能优化的，老板到底在想什么呢...算法还是模型之类的我也不太懂，我只是C++开发工程师啊（这项目写的代码什么注释都没有，代码格式也乱的一批，哪个傻逼写的）



# 11.30(星期六)

公寓里卫生间除了洗手盆，居然没有其他水龙头了。。。于是昨晚买了个小盆，正好能放得下洗手盆，终于可以洗些小衣物了，有点开心

------

一大早出门来公司，发现没开门，原来大家都不加班呐...于是又走了回去...半路又遇到了带了公司钥匙的同事，于是又走回公司了......第一次加班来之前果然应该先跟同事先打声招呼

------

之前装的**opencv3.4**版本一运行就报错，于是装了最新版的...又编译了好一会...配置好后，发现还是这个错误，我要吐了。

我哭了，花了几十分钟，编译到88%，系统cpu资源耗尽卡死了，又重新编译了半小时

------

经过我对**pkg-config**这个软件的深入研究，发现我的系统中该软件默认为交叉编译工具链中内置的工具...也就是说系统一直默认用这玩意在辅助编译x86的**opencv**库？？？于是我追根朔源，终于找到了一直运行报错的原因......居然只是环境变量中交叉编译工具链的路径先于系统默认路径？？？

于是修改**PATH**环境变量中路径的系统默认路径至于交叉编译工具链之前，再次重新编译，终于成功运行**opencv**库函数。这次我真的哭了，我都已经要放弃了。。。



# 12.2(星期一)

好吧，一天都在解决编译**caffe**的问题，改改这，改改那，这个依赖库的版本不对，那个头文件找不到，那个编译器版本不对，**opencv**版本不对...什么样的错误基本都踩完了，最后莫名其妙得编译安装完了...于是又花了不少时间去测试是不是成功了。于是写了个test程序试着编译，又报了找不到**boost**库的错误，我看着系统里一大串安装好的**boost**库，不禁陷入了迷茫...

学校又在催我交论文前三章了，真的好痛苦。。。下班前30分钟写了写，发现写不完，算了，反正都过了提交日期了...

今天胸口感觉堵堵的...确切的位置因该是左肋偏心窝口的位置。我知道这又是我最近积郁太多了，不要再想太多论文和工作学习的事了吧。以前就试过积郁太多导致胃病发作，休息了好几个月才缓过来，想想我的胃真是脆弱，今天又开始疼了，果然是饮食作息不太规律么。。

# 12.5(星期四)

离论文提交日期早就过了好几天了，指导老师也不催，虽然已经给他发信息解释了，可是他也没有回应，不会最后给我毕业设计使绊子吧。。

早上参加了来公司的第一个会议，也算是对公司目前负责的项目有所了解，果然是刚开始做么，各种检测模型都没做好，需求分析我感觉有点乱吧（只是自己感觉），会议最后只决定把简单的需求先做完，分配给我的任务是写一个接口，不过接口要怎么对接，数据怎么来，需要什么样的数据，连大体的框架都没有，我也没办法下米啊。

下午终于把**cmake**基本语法和常用的函数弄清楚了，想试着能不能在**cmake**里用pkg-config工具（毕竟很方便），折腾了一番，能用是能用，不过有点麻烦...

熟悉**cmake**的时候又发现之前编译的**opencv**库缺少不少模块，而通过**anaconda**安装的**opencv**虽然头文件和模块都不缺，可是缺了不少依赖库~~~好吧，明天重新编译。

主管找我了解工作进度...（貌似每个人都找过了），大体汇报了一下，给我指导了编译**caffe**时**protobuf**的版本问题...还给我秀了一波编译时建一个虚的头文件来减少编译大小的奇怪操作，他确定不会出问题吗~~

------

# 12.6（星期五）

不知不觉又到周五，早上重新编译了**opencv**终于没有缺少头文件和依赖库的问题了~

------

原来服务器里有Qt5的框架库嘛，找个时间看看能不能用。